<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #0d1117; font-family: Inter, sans-serif; }
  #determinants { width: 100%; max-width: 960px; margin: 0 auto; }
  .btm-note {
    text-align: center; color: #484f58; font-size: 11px;
    padding: 8px 16px; font-family: Inter, sans-serif;
    max-width: 960px; margin: 0 auto; line-height: 1.5;
  }
  @media (max-width: 600px) {
    .btm-note { font-size: 10px; padding: 6px 10px; }
  }
</style>
</head>
<body>
<div id="determinants"></div>
<div class="btm-note">Skiing speed dominates sprints (β = +19). Misses dominate individual format (60s penalty per miss vs ~25s penalty loop).<br>Shooting speed is the smallest but consistently positive contributor. R² = 0.82–0.96 across formats.</div>
<script>
function isMobile() { return window.innerWidth < 600; }
function isTablet() { return window.innerWidth >= 600 && window.innerWidth < 900; }

const desktopX = ["Sprint M", "Individual M", "Pursuit M", "Mass Start M", "Sprint W", "Individual W", "Pursuit W", "Mass Start W"];
const mobileX = ["Spr M", "Ind M", "Pur M", "MS M", "Spr W", "Ind W", "Pur W", "MS W"];

function getX() { return isMobile() ? mobileX : desktopX; }

const ySkiTime = [19.64069875446912, 16.07642103305745, 11.719914653318304, 5.47760698158531, 18.786355229301737, 12.937962920492092, 11.770043898227303, 4.1626113254824375];
const yMisses = [11.347740633692819, 17.008300023273286, 5.721273186858481, 4.78890189591797, 13.18328659822216, 19.146191206723326, 9.508467147440943, 5.150735052568556];
const yShootSpeed = [2.5866030771107127, 2.894782667620363, 1.8786290093138467, 0.6040035058136827, 3.4152956905931, 0.7275303845936992, 1.9727386697540876, 1.827643752115099];
const customData = ["R² = 0.962, n = 90", "R² = 0.942, n = 89", "R² = 0.816, n = 57", "R² = 0.944, n = 29", "R² = 0.946, n = 91", "R² = 0.887, n = 90", "R² = 0.856, n = 58", "R² = 0.893, n = 30"];

function makeTraces() {
  const x = getX();
  return [
    {"type": "bar", "name": "Ski Time", "x": x, "y": ySkiTime,
     "marker": {"color": "#00d4ff"}, "customdata": customData,
     "hovertemplate": "<b>%{x}</b><br>β Ski Time = %{y:.1f}<br>%{customdata}<extra></extra>"},
    {"type": "bar", "name": "Misses", "x": x, "y": yMisses,
     "marker": {"color": "#e74c3c"}, "customdata": customData,
     "hovertemplate": "<b>%{x}</b><br>β Misses = %{y:.1f}<br>%{customdata}<extra></extra>"},
    {"type": "bar", "name": "Shoot Speed", "x": x, "y": yShootSpeed,
     "marker": {"color": "#FFB347"}, "customdata": customData,
     "hovertemplate": "<b>%{x}</b><br>β Shoot Speed = %{y:.1f}<br>%{customdata}<extra></extra>"}
  ];
}

function getLayout() {
  const mobile = isMobile();
  const tablet = isTablet();
  
  const titleSize = mobile ? 14 : 18;
  const subtitleSize = mobile ? 11 : 13;
  const marginL = mobile ? 40 : 60;
  const marginR = mobile ? 10 : 30;
  const marginT = mobile ? 65 : 80;
  const marginB = mobile ? 60 : 80;
  const tickAngle = mobile ? -45 : -25;
  const tickSize = mobile ? 9 : 11;

  return {
    "title": {
      "text": `<b>What Determines Race Placement</b><br><span style="font-size:${subtitleSize}px;color:#8b949e">Standardized regression coefficients. Positive β = worse placement.${mobile ? '' : ' Hover for model fit.'}</span>`,
      "font": {"size": titleSize, "color": "#c9d1d9", "family": "Inter, sans-serif"},
      "x": 0.5, "xanchor": "center"
    },
    "xaxis": {
      "color": "#c9d1d9", "gridcolor": "#21262d",
      "tickangle": tickAngle,
      "tickfont": {"size": tickSize}
    },
    "yaxis": {
      "color": "#8b949e", "gridcolor": "#21262d", "zeroline": false,
      "title": {"text": mobile ? "Std. β" : "Standardized β (effect on placement)", "font": {"size": mobile ? 10 : 13, "color": "#c9d1d9"}},
      "tickfont": {"size": tickSize}
    },
    "barmode": "group",
    "plot_bgcolor": "#0d1117",
    "paper_bgcolor": "#0d1117",
    "font": {"family": "Inter, sans-serif", "color": "#c9d1d9"},
    "legend": {
      "bgcolor": "rgba(13,17,23,0.9)", "bordercolor": "#30363d", "borderwidth": 1,
      "font": {"size": mobile ? 10 : 11},
      "x": 0.98, "y": 0.98, "xanchor": "right",
      "orientation": mobile ? "h" : "v",
      ...(mobile && {"x": 0.5, "xanchor": "center", "y": 1.02, "yanchor": "bottom"})
    },
    "margin": {"l": marginL, "r": marginR, "t": marginT, "b": marginB},
    "hoverlabel": {"bgcolor": "#161b22", "bordercolor": "#30363d", "font": {"family": "Inter, sans-serif", "size": 12, "color": "#c9d1d9"}},
    "annotations": [{
      "text": "Data: IBU Datacenter | Beyond the Metric",
      "xref": "paper", "yref": "paper", "x": 1, "y": mobile ? -0.22 : -0.18,
      "showarrow": false, "font": {"size": mobile ? 8 : 10, "color": "#484f58"}, "xanchor": "right"
    }]
  };
}

const config = {
  responsive: true,
  displayModeBar: !isMobile(),
  modeBarButtonsToRemove: ['select2d', 'lasso2d', 'autoScale2d'],
  displaylogo: false,
  toImageButtonOptions: {
    format: 'png', filename: 'btm_determinants', height: 800, width: 1200, scale: 2
  }
};

Plotly.newPlot('determinants', makeTraces(), getLayout(), config);

let resizeTimer;
window.addEventListener('resize', function() {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(function() {
    Plotly.react('determinants', makeTraces(), getLayout(), {
      ...config,
      displayModeBar: !isMobile()
    });
  }, 150);
});
</script>
</body>
</html>
