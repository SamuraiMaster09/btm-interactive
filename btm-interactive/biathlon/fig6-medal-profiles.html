<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fig 6 路 Olympic Gold Medalist Profiles</title>
<script src="https://cdn.plot.ly/plotly-2.35.0.min.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #0a0e14; color: #c9d1d9; font-family: 'Segoe UI', system-ui, sans-serif; }
  #chart-container { width: 100%; max-width: 900px; margin: 0 auto; padding: 10px 8px; }
  .controls { display: flex; flex-wrap: wrap; gap: 6px; justify-content: center; margin: 8px 0 4px; }
  .controls button {
    background: #111620; border: 1px solid #1e2633; color: #8b949e;
    padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.78rem;
    transition: all 0.15s;
  }
  .controls button:hover { border-color: #00e5ff88; color: #c9d1d9; }
  .controls button.active { background: #00e5ff22; border-color: #00e5ff; color: #00e5ff; }
  .flag { font-size: 0.85rem; margin-right: 2px; }
  .attribution {
    text-align: center; font-size: 0.7rem; color: #484f58; margin-top: 2px; padding: 0 10px;
  }
</style>
</head>
<body>
<div id="chart-container">
  <div class="controls" id="controls"></div>
  <div id="plot"></div>
  <div class="attribution">Beyond the Metric 路 Data: IBU Datacenter (biathlonresults.com) 路 Milano Cortina 2026</div>
</div>

<script>
const GOLDS = [
  { name:"Quentin Fillon Maillet", nation:"FRA", flag:"", event:"Men's Sprint",
    ski:97.8, acc:94.4, speed:73.3, recov:65.0,
    pct:100, avgShoot:"25.1s", avgRecov:"20.2s", skiRank:"#2", field:90, hits:"10/10" },
  { name:"Maren Kirkeeide", nation:"NOR", flag:"仇", event:"Women's Sprint",
    ski:98.9, acc:91.8, speed:42.9, recov:83.5,
    pct:100, avgShoot:"30.1s", avgRecov:"21.6s", skiRank:"#1", field:91, hits:"10/10" },
  { name:"Johan-Olav Botn", nation:"NOR", flag:"仇", event:"Men's Individual",
    ski:95.5, acc:99.4, speed:25.8, recov:60.7,
    pct:100, avgShoot:"31.2s", avgRecov:"21.0s", skiRank:"#4", field:89, hits:"20/20" },
  { name:"Julia Simon", nation:"FRA", flag:"", event:"Women's Individual",
    ski:96.7, acc:89.4, speed:94.4, recov:98.9,
    pct:95, avgShoot:"23.6s", avgRecov:"20.3s", skiRank:"#3", field:90, hits:"19/20" },
  { name:"Martin Ponsiluoma", nation:"SWE", flag:"葛", event:"Men's Pursuit",
    ski:98.2, acc:96.5, speed:75.4, recov:93.0,
    pct:95, avgShoot:"24.7s", avgRecov:"18.6s", skiRank:"#1", field:57, hits:"19/20" },
  { name:"Lisa Vittozzi", nation:"ITA", flag:"", event:"Women's Pursuit",
    ski:67.2, acc:97.4, speed:93.1, recov:81.9,
    pct:100, avgShoot:"23.0s", avgRecov:"20.7s", skiRank:"#19", field:58, hits:"20/20" },
  { name:"Johannes Dale-Skjevdal", nation:"NOR", flag:"仇", event:"Men's Mass Start",
    ski:82.8, acc:100, speed:58.6, recov:15.5,
    pct:100, avgShoot:"28.4s", avgRecov:"21.9s", skiRank:"#5", field:29, hits:"20/20" },
  { name:"Oc茅ane Michelon", nation:"FRA", flag:"", event:"Women's Mass Start",
    ski:96.7, acc:63.3, speed:83.3, recov:50.0,
    pct:90, avgShoot:"23.7s", avgRecov:"22.1s", skiRank:"#1", field:30, hits:"18/20" }
];

const METRICS = ['Skiing Speed', 'Shooting Accuracy', 'Shooting Speed', 'Recovery Speed'];
const KEYS = ['ski', 'acc', 'speed', 'recov'];
const COLORS = ['#00e5ff', '#00e676', '#ffab00', '#ff5252'];

let currentIdx = 0;

function buildControls() {
  const c = document.getElementById('controls');
  GOLDS.forEach((g, i) => {
    const b = document.createElement('button');
    const shortName = g.name.split(' ').slice(-1)[0];
    b.innerHTML = `<span class="flag">${g.flag}</span>${shortName}`;
    b.onclick = () => selectMedalist(i);
    b.id = `btn-${i}`;
    if (i === 0) b.classList.add('active');
    c.appendChild(b);
  });
}

function makeTraces(g) {
  const vals = KEYS.map(k => g[k]);
  const labels = METRICS.slice().reverse();
  const valsR = vals.slice().reverse();
  const colorsR = COLORS.slice().reverse();

  const rawLabels = [
    `${g.skiRank} of ${g.field}`,
    `${g.hits} (${g.pct}%)`,
    `${g.avgShoot}/bout`,
    `${g.avgRecov}/bout`
  ].reverse();

  return [{
    type: 'bar',
    orientation: 'h',
    y: labels,
    x: valsR,
    marker: {
      color: colorsR.map(c => c + 'cc'),
      line: { color: colorsR, width: 1.5 }
    },
    text: valsR.map((v, i) => `<b>${v.toFixed(0)}th</b> pctl  路  ${rawLabels[i]}`),
    textposition: 'auto',
    textfont: { color: '#e6edf3', size: 12 },
    hovertemplate: '<b>%{y}</b><br>Percentile: %{x:.1f}<br><extra></extra>',
    cliponaxis: false
  }];
}

function makeLayout(g) {
  return {
    title: {
      text: `<b>${g.name}</b> <span style="color:#6e7681">(${g.flag} ${g.nation})</span><br><span style="font-size:13px;color:#8b949e">${g.event} Gold</span>`,
      font: { size: 16, color: '#e6edf3' },
      x: 0.5, xanchor: 'center'
    },
    xaxis: {
      range: [0, 105],
      title: { text: 'Percentile in Race Field', font: { size: 11, color: '#6e7681' } },
      gridcolor: '#1e263322', zerolinecolor: '#1e2633',
      tickfont: { color: '#6e7681', size: 10 },
      dtick: 25
    },
    yaxis: {
      tickfont: { color: '#c9d1d9', size: 12 },
      automargin: true
    },
    shapes: [{
      type: 'line', x0: 50, x1: 50, y0: -0.5, y1: 3.5,
      line: { color: '#c9d1d966', width: 1, dash: 'dot' }
    }],
    annotations: [{
      x: 50, y: 3.8, text: 'Median', showarrow: false,
      font: { size: 9, color: '#6e7681' }
    }],
    paper_bgcolor: '#0a0e14',
    plot_bgcolor: '#0d1117',
    margin: { l: 10, r: 20, t: 70, b: 50 },
    height: 320,
    bargap: 0.35
  };
}

function selectMedalist(idx) {
  currentIdx = idx;
  document.querySelectorAll('.controls button').forEach((b, i) => {
    b.classList.toggle('active', i === idx);
  });
  const g = GOLDS[idx];
  Plotly.react('plot', makeTraces(g), makeLayout(g), {
    displayModeBar: false,
    responsive: true
  });
}

buildControls();
selectMedalist(0);

// Keyboard nav
document.addEventListener('keydown', e => {
  if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
    selectMedalist((currentIdx + 1) % GOLDS.length);
  } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
    selectMedalist((currentIdx - 1 + GOLDS.length) % GOLDS.length);
  }
});
</script>
</body>
</html>
